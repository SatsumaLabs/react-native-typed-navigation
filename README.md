react-native-typed-navigation
=============================

This package provides [flow](https://flow.org/) integration for [react-native-navigation](https://github.com/wix/react-native-navigation) as well as some helpers for common configurations. A wrapper approach (as opposed a `flow-typed` definition compiled from typescript) was chosen as by refactoring the API, it was possible to take advantage of flow's opaque types and variance, providing additional type safety not possible with the original API. The main motivation of this was to have type-checking between a component key and its props when creating a `Layout` to display, similar to what `React.createElement` does.

Keys and Intents
----------------

The biggest difference from the original API is the signature of `registerComponent`. In the original version, it takes a string key and a component generator, and the provided key is then used to refer to the component later.
This was refactored so that it takes a component and returns a unique key (whose representation contains the component's name for debugging purposes) of an opaque type tagged the type of props the component requires, giving it a type equivalent (as the following is only valid in flow â‰¥0.89) to

```js
registerComponent: <Props>(AbstractComponent<{...Props, componentId: CommponentId}>) => ComponentClassKey<Props>
```

These `ComponentClassKey`s can be combined with their respective props by `Intent()` (or the helpers which call it) to define a `ComponentIntent`, this library's equivalent of a `React.Element` (an opaque type which witnesses that the props and key match in type) which is used to define navigation `Layout`s, which are otherwise the same as in `react-native-navigation`.

A number of other identifier types are given their own opaque types to prevent accidental mixing with ordinary strings. Component instance IDs are given their own type `ComponentId` and are wither received through a `componentId` prop or generated globally with the function `makeStaticComponentId(string)`. These static IDs are useful for components such as the root stack which must be manipulated from outside their own hierarchy, such as a main stack which gets manipulated by its sibling in a `sideMenu` layout.

Top bar buttons IDs use the opaque type `ButtonId`, values is uniquely generated by the function `ButtonKey()`. This type is both required in button definitions in the options and is provided to event handlers.

Function reference
------------------

```flow
makeStaticComponentId: string => StaticComponentId;

registerComponent: <Props>(AbstractComponent<{...Props, componentId: CommponentId}>) => ComponentClassKey<Props>;

Intent: <Props>(target: ComponentClassKey<Props>, props: Props, opts?: Options) =>
    {|+ component: ComponentIntent & {
        +name: ComponentClassKey<empty>,
        +passProps: mixed,
        +options?: Opt}
    |};

ButtonKey: string => ButtonId;


mergeOptions: (ComponentId, Options) => void;

setDefaultOptions: Options => void;


setRootLayout: Layout => void;

pushStackLayout: (ComponentId, Layout) => void;

pushStackScreen: <Props>(ComponentId, ComponentClassKey<Props>, Props) => void;

popStack: ComponentId => void;

clearStack: ComponentId => void;

replaceStack: (ComponentId, Layout[]) => void;


pushModalLayout: Layout => void;

pushModalScreen: <Props>(ComponentClassKey<Props>, Props) => void;

popModal: ComponentId => void;

clearModals: () => void


pushOverlay: (LayoutComponent | LayoutExternalComponent) => void

popOverlay: ComponentId => void;


openLeftMenu: ComponentId => void;

closeLeftMenu: ComponentId => void;


type CancelBind = () => void

bindLocalEvents: (Component & EventObserver) => CancelBind;

bindGlobalButtonPressed: (ButtonId, () => void) => CancelBind;

bindDeepLinks: (string => mixed) => CancelBind;

runNavigationApp: (?Options, () => mixed) => void;

```


Options helpers
---------------
